<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
		<title>Title</title>
		<link rel="stylesheet" type="text/css" href="css/index.css" />
		<style>

		</style>
	</head>

	<body>
		<div id="wrap">
			<header id="header">
				<div class="headerTop">
					<div class="headerLeft">
						<a href="##">狗狗</a>
						<span>|</span>
						<a href="##">重庆</a>
					</div>
					<form class="search">
						<input type="text" placeholder="请输入搜索内容。。" />
					</form>
					<div class="headerRight">

					</div>
				</div>
				<div class="headerNav">
					<ul class="navlist">
						<li>
							<a href="javascript:;" class="active">首页</a>
						</li>
						<li>
							<a href="javascript:;">玫瑰</a>
						</li>
						<li>
							<a href="javascript:;">清凉馆</a>
						</li>
						<li>
							<a href="javascript:;">狗狗主粮</a>
						</li>
						<li>
							<a href="javascript:;">零食</a>
						</li>
						<li>
							<a href="javascript:;">医疗保健</a>
						</li>
						<li>
							<a href="javascript:;">玩具</a>
						</li>
						<li>
							<a href="javascript:;">外出</a>
						</li>
					</ul>
					<div class="headerNavline"></div>
				</div>
			</header>
			<div id="content">
				<div class="scroll"></div>
				<div class="ConWrap">
					<div class="banner">
						<ul class="bannerlist">
							<li>
								<a href="##"><img src="img/banner1.jpg" alt="" /></a>
							</li>
							<li>
								<a href="##"><img src="img/banner2.jpg" alt="" /></a>
							</li>
							<li>
								<a href="##"><img src="img/banner3.png" alt="" /></a>
							</li>
							<li>
								<a href="##"><img src="img/banner4.jpg" alt="" /></a>
							</li>
							<li>
								<a href="##"><img src="img/banner5.jpg" alt="" /></a>
							</li>
						</ul>
						<div class="icon">
							<span class="active"></span>
							<span></span>
							<span></span>
							<span></span>
							<span></span>

						</div>
					</div>
					<div class="curreny">
						<div class="currenyLeft">
							<a href="##"><img src="img/curreny-1.jpg" /></a>
						</div>
						<div class="currenyRight">
							<a href="##"><img src="img/curreny-2.jpg" /></a>
						</div>
					</div>
					<div class="content-1">
						<ul class="content-1-list">
							<li>
								<a href="##"><img src="img/content-1.png" alt="" /></a>
							</li>
							<li>
								<a href="##"><img src="img/content-2.png" alt="" /></a>
							</li>
							<li>
								<a href="##"><img src="img/content-3.png" alt="" /></a>
							</li>
							<li>
								<a href="##"><img src="img/content-4.png" alt="" /></a>
							</li>
							<li>
								<a href="##"><img src="img/content-5.png" alt="" /></a>
							</li>
							<li>
								<a href="##"><img src="img/content-6.png" alt="" /></a>
							</li>
							<li>
								<a href="##"><img src="img/content-7.png" alt="" /></a>
							</li>
							<li>
								<a href="##"><img src="img/content-8.png" alt="" /></a>
							</li>
							<li>
								<a href="##"><img src="img/content-9.png" alt="" /></a>
							</li>
							<li>
								<a href="##"><img src="img/content-10.png" alt="" /></a>
							</li>
						</ul>
					</div>
					<div class="content-2">
						<img src="img/content-11.jpg" />
					</div>
					<div class="content-3">
						<img class="content-3-img1" src="img/content-12.jpg" alt="" />
						<img class="content-3-img2" src="img/content-13.jpg" alt="" />
						<img class="content-3-img2" src="img/content-14.jpg" />

					</div>

					<div class="content-4">
						<div class="content-4-1">
							<img src="img/content-15.png" />
						</div>
						<div class="content-4-2">本场结束</div>

						<div class="content-4-4">
							<span>
										23
									</span>
							<span style="border: 0;">
										:
									</span>
							<span>
										00
									</span>

							<img src="img/content-16.png" />
						</div>
					</div>
					<div class="content-5">
						<ul class="content-5list">
							<li><img src="img/nav1.jpg" alt="" />
								<div>
									<span class="s">￥100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav4.jpg" alt="" />
								<div>
									<span class="s">￥100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav6.jpg" alt="" />
								<div>
									<span class="s">￥100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav5.jpg" alt="" />
								<div>
									<span class="s">￥100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav7.jpg" alt="" />
								<div>
									<span class="s">￥100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav8.jpg" alt="" />
								<div>
									<span class="s">￥100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav9.jpg" alt="" />
								<div>
									<span class="s">￥100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav10.jpg" alt="" />
								<div>
									<span class="s">￥100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav11.jpg" alt="" />
								<div>
									<span class="s">￥100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav12.jpg" alt="" />
								<div>
									<span class="s">￥100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav13.jpg" alt="" />
								<div>
									<span class="s">￥100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav14.jpg" alt="" />
								<div>
									<span class="s">￥100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav14.jpg" alt="" />
								<div>
									<span class="s">100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav15.jpg" alt="" />
								<div>
									<span class="s">100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav16.jpg" alt="" />
								<div>
									<span class="s">100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav17.jpg" alt="" />
								<div>
									<span class="s">100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav18.jpg" alt="" />
								<div>
									<span class="s">100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav19.jpg" alt="" />
								<div>
									<span class="s">100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav20.jpg" alt="" />
								<div>
									<span class="s">100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav21.jpg" alt="" />
								<div>
									<span class="s">100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav22.jpg" alt="" />
								<div>
									<span class="s">100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav23.jpg" alt="" />
								<div>
									<span class="s">100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav1.jpg" alt="" />
								<div>
									<span class="s">100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav24.jpg" alt="" />
								<div>
									<span class="s">100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav25.jpg" alt="" />
								<div>
									<span class="s">100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
							<li><img src="img/nav26.jpg" alt="" />
								<div>
									<span class="s">100</span>
									<sapn class="s1">省13</sapn>
								</div>
							</li>
						</ul>
					</div>
					<div class="content-6"></div>
					<div class="content-7">
						<div class="content-7-1">
							<img src="img/content-17.png" alt="" />
						</div>
						<div class="content-7-2">
							<img src="img/new5.jpg" />
							<img src="img/new6.jpg" alt="" />
						</div>
					</div>
					<div class="content-8"></div>
					<div class="conten-9">
						<img src="img/new-7.jpg" />
					</div>
					<div class="content-10"></div>
					<div class="conten-11">
						<div class="conten-11-1">
							<img class="conten-11-M1" src="img/new-8.jpg" />
							<img class="conten-11-M2" src="img/new-9.jpg" />
						</div>
					</div>
					<div class="content-12">
						<ul class="content-12list">
							<li><img src="img/big1.jpg" alt="" /></li>
							<li><img src="img/big2.jpg" alt="" /></li>
							<li><img src="img/big3.jpg" alt="" /></li>
							<li><img src="img/big4.jpg" alt="" /></li>
							<li><img src="img/big5.jpg" alt="" /></li>
							<li><img src="img/big6.jpg" alt="" /></li>
							<li><img src="img/big7.jpg" alt="" /></li>
							<li><img src="img/big8.jpg" alt="" /></li>
							<li><img src="img/big9.jpg" alt="" /></li>
							<li><img src="img/big10.jpg" alt="" /></li>
							<li><img src="img/big11.jpg" alt="" /></li>
						</ul>
					</div>
				</div>
			</div>

		</div>
		<footer id="footer">
			<ul>
				<li style="margin-left: 40px;"></li>
				<li style="background-position: -113px -39px;"></li>
				<li style="background-position: -121px -79px;"></li>
				<li style="background-position: -121px -122px;"></li>
			</ul>
		</footer>
		<script type="text/javascript" src="js/tool.js"></script>
		<script type="text/javascript" src="js/transform.js"></script>
		<script type="text/javascript">
			document.addEventListener('touchstart', function(event) {
				event.preventDefault();
			});

			//点透
			!(function() {
				var aNodes = document.querySelectorAll('a');
				for(var i = 0; i < aNodes.length; i++) {
					aNodes[i].addEventListener('touchstart', function() {
						window.location.href = this.href;
					});
				};
			})();

			//rem适配
			!(function() {
				var width = document.documentElement.clientWidth;
				var styleNode = document.createElement('style');
				styleNode.innerHTML = 'html{font-size: ' + width / 16 + 'px !important;}';
				document.head.appendChild(styleNode);
			})();

			window.onload = function() {

				var navlist = document.querySelector('.navlist');
				var contentlist = document.querySelector('.content-5list');
				var content = document.querySelector('#content')
				var header = document.querySelector('#header')
				content.style.height = document.documentElement.clientHeight - header.offsetHeight + 'px';
				console.log(document.documentElement.clientHeight)

				focusBind()

				navList(navlist)

				banner()

				navList(contentlist)

				contentmove()

			}

			function focusBind() {
				var input = document.querySelector(".search input[type='text']");
				input.addEventListener('touchstart', function() {
					input.focus();
					event.stopPropagation();
					event.preventDefault();

				});
				document.addEventListener('touchstart', function() {

					input.blur();
				});
			}
 
			function navList(navlist) {

				var eleX = 0;

				var starX = 0;

				var left = 0

				var t1 = 0;

				var t2 = 0;

				var s1 = 0;

				var s2 = 0;

				var disDance = 0;

				var distime = 1;

				navlist.addEventListener('touchstart', function(event) {

					navlist.style.transition = 'none'
					eleX = navlist.offsetLeft;
					starX = event.changedTouches[0].clientX;
					s1 = eleX;
					t1 = new Date().getTime();

					disDance = 0;

				});

				navlist.addEventListener('touchmove', function(event) {

					var endX = event.changedTouches[0].clientX;
					var disX = endX - starX;

					left = disX + eleX;

					if(left > 0) {
						var scale = 1 - (left / document.documentElement.clientWidth);

						left = scale * left

					} else if(left < (document.documentElement.clientWidth - navlist.offsetWidth)) {

						var over = Math.abs(left) - Math.abs(document.documentElement.clientWidth - navlist.offsetWidth)

						var scale = 1 - (over / document.documentElement.clientWidth);

						left = document.documentElement.clientWidth - navlist.offsetWidth - scale * over;

					}
					navlist.style.left = left + 'px';

					s2 = navlist.offsetLeft;
					t2 = new Date().getTime();

					disDance = s2 - s1;
					distime = t2 - t1;
				});

				navlist.addEventListener('touchend', function(event) {
					var speed = disDance / distime;

					console.log('distime:' + distime);
					console.log('disDance:' + disDance);
					console.log('speed:' + speed);

					left = left + speed * 100;

					var bezier = ' ';
					if(left > 0) {

						bezier = 'cubic-bezier(.14,1.72,.87,1.46) ';

						left = 0;

					}
					if(left < (document.documentElement.clientWidth - navlist.offsetWidth)) {

						bezier = 'cubic-bezier(.14,1.72,.87,1.46) ';

						left = (document.documentElement.clientWidth - navlist.offsetWidth);

					}

					navlist.style.transition = '0.5s ' + bezier;

					navlist.style.left = left + 'px';

				});

			}

			function banner() {

				//获取元素
				var wrap = document.querySelector('#wrap #content .banner')
				var list = document.querySelector('#wrap #content .banner .bannerlist');

				list.innerHTML += list.innerHTML;

				var liNodes = document.querySelectorAll('#wrap #content .banner .bannerlist li');
				var spanNodes = document.querySelectorAll('#wrap #content .banner .icon > span');

				console.log(wrap, list);

				//布局样式区域

				var styleNode = document.createElement('style');
				styleNode.innerHTML = '#wrap #content .banWrap{height: ' + liNodes[0].offsetHeight + 'px;}';
				styleNode.innerHTML += '#wrap #content .banWrap .banList{width: ' + liNodes.length + '00%;}';
				styleNode.innerHTML += '#wrap #content .banWrap .banList li{width: ' + 100 / liNodes.length + '%;}'
				document.head.appendChild(styleNode);

				//滑屏
				//定义元素与手指初始位置
				var eleX = 0;
				var startX = 0;
				var translateX = 0;
				var now = 0;

				var disY = 0;

				var isFirst = true;

				var isX = true;

				var timer = null;
				var starY = 0

				wrap.addEventListener('touchstart', function(event) {
					list.style.transition = 'none';
					clearInterval(timer);

					if(now == 0) {
						now = 5
					} else if(now == 9) {
						now = 4;
					}
					transformCss(list, 'translateX', -now * document.documentElement.clientWidth);
					eleX = transformCss(list, 'translateX');

					startX = event.changedTouches[0].clientX;

					starY = event.changedTouches[0].clientY

					isFirst = true;
					isX = true;
				});
				wrap.addEventListener('touchmove', function(event) {
					list.style.transition = 'none';
					clearInterval(timer);
					// 判断isX是否等于false。
					if(!isX) {
						return;
					}
					var endY = event.changedTouches[0].clientY;
					disY = endY - starY;
					var endX = event.changedTouches[0].clientX;
					var disX = endX - startX;

					if(isFirst) {
						//		第一次进入touchmove
						isFirst = false;
						if(Math.abs(disY) > Math.abs(disX)) {
							//判断是否是上下移动，如果是上下移动就让isX等于false；
							isX = false;
							return;
						}
					}

					translateX = disX + eleX;
					transformCss(list, 'translateX', translateX);
				});
				wrap.addEventListener('touchend', function() {
					list.style.transition = 'none';

					var left = transformCss(list, 'translateX');
					now = Math.round(-left / document.documentElement.clientWidth);
					console.log(now)
					transformCss(list, 'translateX', -now * document.documentElement.clientWidth);

					for(var i = 0; i < spanNodes.length; i++) {
						removeClass(spanNodes[i], 'active')
					}
					var a = now % spanNodes.length
					addClass(spanNodes[now % spanNodes.length], 'active')

					auto();

				});

				//自动轮播
				auto();

				function auto() {

					timer = setInterval(function() {
						//无缝
						// now == 9 , now = 4
						if(now == liNodes.length - 1) {
							now = spanNodes.length - 1;
							//清除过渡
							list.style.transition = 'none';
							//真正的跳转动作
							transformCss(list, 'translateX', -now * document.documentElement.clientWidth)
						}

						setTimeout(function() {
							now++;
							//过渡
							list.style.transition = '0.5s';
							//写入
							transformCss(list, 'translateX', -now * document.documentElement.clientWidth)

							//小圆点  				
							//1.统一给所有span元素添加 class = ''
							for(var i = 0; i < spanNodes.length; i++) {
								spanNodes[i].className = ''
							};
							//2.切换到谁，谁对应的class = 'active'
							spanNodes[now % spanNodes.length].className = 'active'
						}, 20)

					}, 1000)

				}

			};

			function contentmove() {
				var wrap = document.querySelector('#content .ConWrap');
				var content = document.querySelector('#content')
				var footer = document.getElementById('footer')
				
				var srcoll=document.querySelector('#wrap #content .scroll ');
				
				
				var scorl=content.offsetHeight/wrap.offsetHeight;
			
				srcoll.style.height=scorl*content.offsetHeight+10+'px'
				
				console.log(srcoll)
				
				srcoll.style.opacity = '0';
				
				var eleY = 0;
				var startY = 0;
				var translsteY = 0
				var startX = 0;

				var first = true;
				
				var isX = true;
                
                var t1=0;
                var t2=0;
                var s1=0;
                var s2=0;
                
 
                
                
                  

				content.addEventListener('touchstart', function(event) {
					
					srcoll.style.opacity='1';
					
					wrap.style.transition='0s';
					
					eleY = transformCss(wrap, 'translateY')

					startY = event.changedTouches[0].clientY;
					
					startX = event.changedTouches[0].clientX;
                     
                     s1=eleY;

					first = true;
					isX = true;
					
					t1=new Date().getTime();
					console.log(t1);
				})
				content.addEventListener('touchmove', function(event) {
					if(!isX) {
						return;
					}
                    wrap.style.transition='0s';
                    
					var endY = event.changedTouches[0].clientY;
					var endX = event.changedTouches[0].clientX;
                     
         
                 
					var disY = endY - startY

					var disX = endX - startX
                    
                   

					if(first) {
						first = false;
				
						if(Math.abs(disX) > Math.abs(disY)) {
							isX = false
							
						}
					}

					translsteY = disY + eleY;
					var speed = 0.8 - translsteY / content.offsetHeight
					if(translsteY > 0) {
						translsteY = translsteY * speed
					} else if(translsteY < content.offsetHeight - wrap.offsetHeight) {
						translsteY = content.offsetHeight - wrap.offsetHeight - footer.offsetHeight
					}

					transformCss(wrap, 'translateY', translsteY)
					
					s2 = transformCss(wrap, 'translateY')
					
					var dis = transformCss(wrap,'translateY')*scorl;
			    			
			    	transformCss(srcoll,'translateY',-dis)
                    
				})
				content.addEventListener('touchend', function(event) {
					t2=new Date().getTime();
					
					var sped=(s2-s1)/(t2-t1);
					
					console.log(sped)
					
					translsteY=translsteY+sped*100;
					wrap.style.transition='1s';
					if(translsteY > 0) {
						translsteY = 0
					}else if(translsteY < content.offsetHeight - wrap.offsetHeight) {
						translsteY = content.offsetHeight - wrap.offsetHeight - footer.offsetHeight
					}

					transformCss(wrap, 'translateY', translsteY);
					
					setTimeout(function(){
						srcoll.style.opacity='0';
						
					},1500)
				});
			}
		</script>
	</body>

</html>